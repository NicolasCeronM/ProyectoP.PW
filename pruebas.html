<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Ejemplo de API de regiones y comunas de Chile</title>
  </head>
  <body>
    <label for="region-select">Región:</label>
    <select id="region-select">
      <option value="">Seleccione una región</option>
    </select>

    <label for="comuna-select">Comuna:</label>
    <select id="comuna-select">
      <option value="">Seleccione una comuna</option>
    </select>

    <script>
      const regionSelect = document.getElementById('region-select');
      const comunaSelect = document.getElementById('comuna-select');

      fetch('https://gist.githubusercontent.com/juanbrujo/0fd2f4d126b3ce5a95a7dd1f28b3d8dd/raw/b8575eb82dce974fd2647f46819a7568278396bd/comunas-regiones.json')
        .then(response => response.json())
        .then(data => {
          // Obtener lista de regiones
          const regiones = data.regiones;

          // Agregar opciones al select de regiones
          regiones.forEach(region => {
            const option = document.createElement('option');
            option.value = region.region;
            option.text = region.region;
            regionSelect.appendChild(option);
          });

          // Función que actualiza las comunas disponibles según la región seleccionada
          function actualizarComunas() {
            const regionSeleccionada = regionSelect.value;
            const comunas = data.regiones.find(region => region.region === regionSeleccionada).comunas;

            // Limpiar opciones anteriores del select de comunas
            comunaSelect.innerHTML = '<option value="">Seleccione una comuna</option>';

            // Agregar opciones al select de comunas
            comunas.forEach(comuna => {
              const option = document.createElement('option');
              option.value = comuna;
              option.text = comuna;
              comunaSelect.appendChild(option);
            });
          }

          // Actualizar comunas al cambiar la región seleccionada
          regionSelect.addEventListener('change', actualizarComunas);
        })
        .catch(error => console.error(error));
    </script>
  </body>
</html>
